# 外星入侵游戏 (Alien Invasion)

这是一个基于Python和Pygame开发的经典射击游戏，玩家控制飞船抵御外星人入侵。

## 🎮 游戏特性

### 核心功能
- 飞船移动和射击
- 外星人舰队移动和攻击
- 计分系统和等级提升
- 生命值管理

### 新增功能

#### 1. 补给系统 (Power-ups)
- **绿色补给**：增加生命值
- **蓝色补给**：增大子弹宽度，提升攻击范围
- **实现细节**：
  - 创建了 `PowerUp` 类管理补给品
  - 补给随机生成，0.5%概率掉落
  - 飞船碰撞补给后获得相应效果
  - 绿色补给恢复1点生命值
  - 蓝色补给增加子弹宽度3像素

#### 2. 最高分持久化保存
- **问题修复**：游戏退出时最高分会被重置
- **解决方案**：
  - 添加了 `high_score.json` 文件保存最高分
  - 在 `GameStats` 类中实现 `_load_high_score()` 方法加载最高分
  - 在 `GameStats` 类中实现 `save_high_score()` 方法保存最高分
  - 在游戏退出前（按Q键或点击关闭按钮）自动保存最高分

#### 3. 外星人射击功能
- **新特性**：外星人现在可以随机向玩家飞船发射子弹
- **实现细节**：
  - 创建了 `AlienBullet` 类管理外星子弹
  - 在 `Settings` 中添加外星子弹参数（速度、尺寸、颜色、射击概率）
  - 实现 `_alien_shooting()` 方法控制随机射击
  - 添加 `_update_alien_bullets()` 方法更新外星子弹位置
  - 添加 `_check_alien_bullet_ship_collisions()` 方法检测碰撞

#### 4. 飞船盾牌保护系统
- **新特性**：飞船获得盾牌保护，只有从侧面射来的子弹才能摧毁飞船
- **实现细节**：
  - 在 `Ship` 类中添加盾牌矩形和激活状态
  - 盾牌显示为青色边框，比飞船稍大
  - 修改碰撞检测逻辑：正面子弹被盾牌阻挡，侧面子弹可摧毁飞船
  - 在屏幕上绘制盾牌效果

#### 5. 音效系统
- **新特性**：添加丰富的音效增强游戏体验
- **音效包括**：
  - 玩家射击声 (`shoot.wav`)
  - 外星人射击声 (`alien_shoot.wav`)
  - 爆炸声 (`explosion.wav`) - 用于飞船被击中或外星人被消灭
  - 背景音乐 (`background.mp3`) - 循环播放
- **实现特点**：
  - 使用 `pygame.mixer` 管理音效
  - 音效文件缺失时游戏仍可正常运行
  - 音量可调节（背景音乐默认30%音量）

#### 6. 子弹系统优化
- **无限子弹**：移除了子弹数量限制（从3发改为999发）
- **子弹宽度**：可通过蓝色补给进行升级
- **视觉效果**：子弹颜色为深灰色，尺寸合理

## 游戏玩法

### 控制方式
- **左右箭头键**：移动飞船
- **空格键**：发射子弹
- **Q键**：退出游戏
- **P键**：开始游戏（或点击Play按钮）

### 游戏规则
- 消灭外星人获得分数
- 每消灭整个舰队提升等级，游戏速度加快
- 飞船被外星人或外星子弹击中会失去一条生命
- 盾牌可以阻挡正面射来的外星子弹，但侧面攻击仍然有效
- 生命值归零游戏结束
- 收集绿色补给增加生命值
- 收集蓝色补给增大子弹宽度
- 子弹数量无限制（999发）

## 🛠️ 技术实现

### 文件结构
```
alien_invasion_game/
├── alien_invasion.py    # 主游戏文件
├── alien.py            # 外星人类
├── alien_bullet.py     # 外星子弹类（新增）
├── bullet.py           # 玩家子弹类
├── button.py           # 按钮类
├── game_stats.py       # 游戏统计类
├── powerup.py          # 补给品类（新增）
├── scoreboard.py       # 计分板类
├── settings.py         # 游戏设置类
├── ship.py            # 飞船类
├── images/            # 图片资源
│   ├── alien.bmp
│   └── ship.bmp
└── sounds/            # 音效文件（新增）
    ├── README.md      # 音效文件说明
    ├── shoot.wav      # 玩家射击声（可选）
    ├── alien_shoot.wav # 外星人射击声（可选）
    ├── explosion.wav   # 爆炸声（可选）
    └── background.mp3  # 背景音乐（可选）
```

### 关键代码修改

#### 路径处理优化
- 使用 `os.path.join(os.path.dirname(__file__), 'images', 'ship.bmp')` 确保图片路径正确
- 避免工作目录依赖问题

#### 游戏循环增强
- 添加了外星子弹更新和碰撞检测
- 改进了盾牌碰撞逻辑
- 音效播放集成到关键游戏事件中

## 🚀 运行游戏

### 环境要求
- Python 3.x
- Pygame库

### 安装依赖
```bash
pip install pygame
```

### 启动游戏
```bash
cd alien_invasion_game
python alien_invasion.py
```

### 可选音效文件
如果需要音效功能，请将音效文件放入 `sounds/` 目录，具体格式要求参见 `sounds/README.md`。

## 🎨 扩展建议

游戏架构支持进一步扩展，例如：
- 添加更多类型的补给（速度提升、多重射击等）
- 添加更多类型的外星人和子弹
- 实现道具系统（护盾充能、武器升级等）
- 添加更多关卡和Boss战
- 实现多人游戏模式
- 添加更多视觉特效和动画
- 添加补给效果持续时间限制
- 实现不同类型的子弹（穿透、爆炸等）

## 📄 许可证

本项目基于Python Crash Course教程开发，包含大量原创扩展功能。

## 🔄 最近更新

### 2024年新增功能
- **补给系统**：绿色补给恢复生命值，蓝色补给增大子弹宽度
- **无限子弹**：移除子弹数量限制，提升游戏体验
- **子弹宽度升级**：通过蓝色补给可以增大子弹尺寸，提高命中率

